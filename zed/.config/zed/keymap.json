// Zed keymap
//
// For information on binding keys, see the Zed
// documentation: https://zed.dev/docs/key-bindings
//
// To see the default key bindings run `zed: open default keymap`
// from the command palette.
[
	// Terminal
	{
		"context": "Workspace",
		"bindings": {
			"ctrl-/": "workspace::ToggleBottomDock",
		},
	},
	{
		"context": "Dock || Terminal || Editor",
		"bindings": {
			// Window's motions
			"ctrl-h": "workspace::ActivatePaneLeft",
			"ctrl-l": "workspace::ActivatePaneRight",
			"ctrl-k": "workspace::ActivatePaneUp",
			"ctrl-j": "workspace::ActivatePaneDown",
		},
	},
	{
		"context": "!Editor && TabSwitcher",
		"bindings": {
			"d": "tab_switcher::CloseSelectedItem",
			"j": ["workspace::SendKeystrokes", "down"],
			"k": ["workspace::SendKeystrokes", "up"],
		},
	},
	{
		"context": "AgentPanel",
		"bindings": {
			"space j k": "workspace::ToggleRightDock",
		},
	},
	{
		"context": "GitPanel",
		"bindings": {
			"q": "git_panel::Close",
		},
	},
	// File panel (netrw)
	{
		"context": "ProjectPanel && not_editing",
		"bindings": {
			"a": "project_panel::NewFile",
			"A": "project_panel::NewDirectory",
			"r": "project_panel::Rename",
			"d": "project_panel::Delete",
			"x": "project_panel::Cut",
			"c": "project_panel::Copy",
			"p": "project_panel::Paste",
			// Close project panel as project file panel on the right
			"q": "workspace::ToggleRightDock",
			"space e": "workspace::ToggleRightDock",
			":": "command_palette::Toggle",
			"/": "project_panel::NewSearchInDirectory",
			"enter": "project_panel::OpenPermanent",
			"escape": "project_panel::ToggleFocus",
			"h": "project_panel::CollapseSelectedEntry",
			"j": "menu::SelectNext",
			"k": "menu::SelectPrevious",
			"l": "project_panel::ExpandSelectedEntry",
			"o": "project_panel::OpenPermanent",
			"shift-d": "project_panel::Delete",
			"shift-r": "project_panel::Rename",
			"t": "project_panel::OpenPermanent",
			"v": "project_panel::OpenPermanent",
			"shift-g": "menu::SelectLast",
			"g g": "menu::SelectFirst",
			"-": "project_panel::SelectParent",
			"ctrl-6": "pane::AlternateFile",
		},
	},
	// Empty pane, set of keybindings that are available when there is no active editor
	{
		"context": "EmptyPane || SharedScreen",
		"bindings": {
			// Open file finder
			"space space": "file_finder::Toggle",
			// New file
			"space f n": "workspace::NewFile",
			// Open recent project
			"space f p": "projects::OpenRecent",
			// Search in all the files
			"space s g": "workspace::NewSearch",
			// Quit zed
			"space q q": "zed::Quit",
		},
	},
	{
		"context": "Editor && VimControl && !VimWaiting && !menu",
		"bindings": {
			// ai assistant actions
			"space a a": "agent::ToggleFocus",
			"space a e": "assistant::InlineAssist",
			// Git
			"space g g": [
				"task::Spawn",
				{
					"task_name": "LazyGit",
					"reveal_target": "center",
				},
			],
			"space g h D": "git::Diff",
			"space g h d": "editor::ExpandAllDiffHunks",
			"space g h r": "git::Restore",
			"space g h R": "git::RestoreFile",
			"space g b": "git::Blame",
			// Open markdown preview
			"space m p": "markdown::OpenPreview",
			"space m P": "markdown::OpenPreviewToTheSide",
			// Open recent project
			"space f p": "projects::OpenRecent",
			// Search word under cursor in current pane
			"space s w": "buffer_search::Deploy",
			// Search word under cursor in all panes
			"space s W": "pane::DeploySearch",
			// Tab things. Almost as good as harpoon.
			"space 1": ["pane::ActivateItem", 0],
			"space 2": ["pane::ActivateItem", 1],
			"space 3": ["pane::ActivateItem", 2],
			"space 4": ["pane::ActivateItem", 3],
			"space 5": ["pane::ActivateItem", 4],
			"space 6": ["pane::ActivateItem", 5],
			"space 7": ["pane::ActivateItem", 6],
			"space 8": ["pane::ActivateItem", 7],
			"space 9": ["pane::ActivateItem", 8],
			"space 0": "pane::ActivateLastItem",
			"space b n": "pane::ActivateNextItem",
			"space b p": "pane::ActivatePreviousItem",
			"space o": "tab_switcher::Toggle",
			// Jump to the previous location
			"space b b": "pane::AlternateFile",
			// Close buffer
			"space b d": "pane::CloseActiveItem",
			// Close inactive buffers
			"space b q": "pane::CloseOtherItems",
			// New file
			"space b a": "workspace::NewFile",
			// Search in the current buffer
			"space s b": "vim::Search",
			// Search in all the files
			"space s g": "workspace::NewSearch",
			"space /": "workspace::NewSearch",
			// LSP & Code actions
			"space c a": "editor::ToggleCodeActions",
			"space s d": "diagnostics::Deploy",
			"space s s": "outline::Toggle",
			// Format
			"space c f": "editor::Format",
			"space c s": "workspace::Save",
			// File explorer
			"space e": "workspace::ToggleRightDock",
			// Telescope
			"space f f": "file_finder::Toggle",
			"space space": "file_finder::Toggle",
			// Terminal
			"space t": "workspace::ToggleBottomDock",
			// Windows management
			"space w s": "pane::SplitDown",
			"space w v": "pane::SplitRight",
			"space w d": "pane::CloseAllItems",
			// Jump to hunks
			"g j": "editor::GoToHunk",
			"g k": "editor::GoToPreviousHunk",
			// Jump to diagnostic
			"g d j": "editor::GoToDiagnostic",
			"g d k": "editor::GoToPreviousDiagnostic",
			// other editing on config
			"space c r ": "editor::Rename",
			"space a t": "workspace::ToggleRightDock",
			// Toggle inlay hints
			"space u i": "editor::ToggleInlayHints",
			// Toggle soft wrap
			"space u w": "editor::ToggleSoftWrap",
		},
	},
	{
		"context": "Editor && vim_mode == visual && !VimWaiting && !VimObject",
		"bindings": {
			// Line's Motions
			"shift-j": "editor::MoveLineDown",
			"shift-k": "editor::MoveLineUp",
		},
	},
	// Center the cursor on the screen when scrolling and find all references
	{
		"context": "VimControl && !menu",
		"bindings": {
			"ctrl-d": ["workspace::SendKeystrokes", "ctrl-d z z"],
			"ctrl-u": ["workspace::SendKeystrokes", "ctrl-u z z"],
			"n": ["workspace::SendKeystrokes", "n z z z v"],
			"shift-n": ["workspace::SendKeystrokes", "shift-n z z z v"],
			"g r": "editor::FindAllReferences",
		},
	},
	{
		"context": "vim_operator == d",
		"bindings": {
			"o": "editor::ExpandAllDiffHunks",
			"r": "git::Restore",
		},
	},
	{
		"context": "vim_mode == normal || vim_mode == visual",
		"bindings": {
			"s": "vim::PushSneak",
			"S": "vim::PushSneakBackward",
		},
	},
	{
		"context": "vim_operator == a || vim_operator == i || vim_operator == cs",
		"bindings": {
			"b": "vim::AnyBrackets",
		},
	},
]
